---
Title: "Test parameter"
output: html_document
params:
  country: "Netherlands"
  year: 2021
  month: 1
---


# Parametized Data

To prove my skills in the producing parametized .Rmd's, I've used an online COVID-19 dataset and parametized the visualisation of this data file. For this parameterization, the country of the data, the year of the data and the months which the data covers have been added as variables. 

In order to prove this, three parametized pages have been made: 

Click here for COVID data in the Netherlands for the entire year of 2021

Click here for COVID data in Norway during january till june of 2020

Click here for COVID data in Germany From March till May in 2022

```{r}
library(here)
library(tidyverse)
library(ggplot2)
```

Parameter test 
```{r}

```


```{r}
############################################################### Reading data
covid_data<-read.csv("./data.raw/data.csv")
covid_data_vis<-covid_data

############################################################### Mangling data
covid_years<-covid_data$year %>% unique()
covid_data_vis$year<-factor(as.character(covid_data$year), levels = as.character(covid_years))

months<-c("January", "Februari", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December")
months_dataframe<-data.frame(MONTH=months,
                             month=seq(1:12))
months_dataframe$MONTH<-factor(months_dataframe$MONTH, levels = months)
covid_data_vis<-left_join(covid_data_vis, months_dataframe, by = "month")

############################################################### Creating visualisation: Cases per month
covid_data_vis %>% filter(countriesAndTerritories==params$country,
                          year==params$year) %>% group_by(MONTH, year) %>% summarise(
  cases=mean(cases, na.rm=TRUE)
) %>% ggplot(aes(x=MONTH, y=cases))+
  geom_point(aes(color=year))+
  geom_line(aes(group=year, color=year))+
  theme_bw()+
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  labs(
    title=paste0("SARS-COV 2 cases in ",params$country, " per month in ", params$year),
    subtitle = "Data from ECDC",
    x="Month",
    y="COVID-19 cases",
    color="Year"
  )

############################################################# Creating visualisation: Deaths per month
covid_data_vis %>% filter(countriesAndTerritories==params$country,
                          year==params$year) %>% group_by(month, year) %>% summarise(
  deaths=mean(deaths, na.rm=TRUE)
) %>% ggplot(aes(x=month, y=deaths))+
  geom_point(aes(color=year))+
  geom_line(aes(group=year, color=year))+
  theme_bw()+
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  labs(
    title=paste0("SARS-COV 2 deaths in ",params$country, " per month in ", params$year),
    subtitle = "Data from ECDC",
    x="Month",
    y="COVID-19 deaths",
    color="Year"
  )+
  scale_x_continuous(breaks=(seq(1:12)), labels = months)
```


